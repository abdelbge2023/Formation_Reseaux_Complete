<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab VLSM - Plateforme P√©dagogique R√©seau</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --primary: #2E7D32;
            --secondary: #1565C0;
            --accent: #FF6D00;
            --warning: #D32F2F;
            --success: #388E3C;
            --info: #0277BD;
            --dark: #263238;
            --light: #F5F5F5;
            --border: #BDBDBD;
            --cisco: #049FD9;
            --hp: #0096D6;
            --theory: #7B1FA2;
            --lab: #FF9800;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, var(--primary) 0%, #1B5E20 100%);
            color: white;
            padding: 2rem;
            text-align: center;
            border-radius: 15px;
            margin-bottom: 2rem;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.1) 0%, transparent 50%);
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        header .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 1rem;
        }

        .badge {
            display: inline-block;
            background: var(--accent);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin: 0.5rem;
        }

        .nav-tabs {
            display: flex;
            background: white;
            border-radius: 12px;
            padding: 10px;
            margin-bottom: 2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            flex-wrap: wrap;
            gap: 5px;
        }

        .nav-tab {
            flex: 1;
            min-width: 150px;
            padding: 15px 20px;
            background: transparent;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: var(--dark);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .nav-tab:hover {
            background: var(--light);
            transform: translateY(-2px);
        }

        .nav-tab.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 12px rgba(46, 125, 50, 0.3);
        }

        .tab-content {
            display: none;
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
            animation: fadeIn 0.5s ease-in;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .learning-objective {
            background: linear-gradient(135deg, #FFEAA7 0%, #FFD43B 100%);
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1.5rem 0;
            border-left: 4px solid var(--accent);
        }

        .concept-explanation {
            background: var(--light);
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1.5rem 0;
            border-left: 4px solid var(--info);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .input-group label {
            font-weight: 600;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .input-group input, .input-group select {
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.1);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: #1B5E20;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(46, 125, 50, 0.3);
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            background: #0D47A1;
            transform: translateY(-2px);
        }

        .button-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin: 2rem 0;
        }

        .binary-tutorial {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            margin: 2rem 0;
        }

        .bits-container {
            display: flex;
            flex-wrap: wrap;
            gap: 3px;
            justify-content: center;
            margin: 1.5rem 0;
            padding: 1rem;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }

        .bit {
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
            font-weight: bold;
            font-size: 0.8rem;
            position: relative;
            transition: all 0.3s ease;
            cursor: help;
        }

        .bit:hover {
            transform: scale(1.1);
            z-index: 10;
        }

        .bit-network {
            background: var(--primary);
            color: white;
        }

        .bit-subnet {
            background: var(--secondary);
            color: white;
        }

        .bit-host {
            background: var(--accent);
            color: white;
        }

        .bit-1 {
            background: var(--success);
            color: white;
        }

        .bit-0 {
            background: var(--border);
            color: #666;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin: 1rem 0;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .exercise-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .exercise-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-top: 4px solid var(--lab);
            transition: transform 0.3s ease;
        }

        .exercise-card:hover {
            transform: translateY(-5px);
        }

        .difficulty-badge {
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .difficulty-easy {
            background: #C8E6C9;
            color: #2E7D32;
        }

        .difficulty-medium {
            background: #FFF9C4;
            color: #F57F17;
        }

        .router-lab {
            background: linear-gradient(135deg, #FFEAA7 0%, #FFD43B 100%);
            padding: 2rem;
            border-radius: 15px;
            margin: 2rem 0;
        }

        .config-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .config-tab {
            padding: 10px 20px;
            background: rgba(255,255,255,0.3);
            border: none;
            border-radius: 8px;
            color: var(--dark);
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .config-tab.active {
            background: rgba(255,255,255,0.6);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .config-content {
            background: rgba(255,255,255,0.3);
            padding: 1.5rem;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .config-code {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            overflow-x: auto;
            margin: 1rem 0;
        }

        .config-comment {
            color: #6A9955;
        }

        .config-keyword {
            color: #569CD6;
        }

        .config-string {
            color: #CE9178;
        }

        .config-number {
            color: #B5CEA8;
        }

        .table-responsive {
            overflow-x: auto;
            margin: 1.5rem 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: var(--light);
            font-weight: 600;
            color: var(--dark);
        }

        tr:hover {
            background: #f8f9fa;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-top: 4px solid var(--primary);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
            display: block;
        }

        .stat-label {
            color: var(--dark);
            font-size: 0.9rem;
        }

        .tip-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 1rem;
        }

        .tip-icon {
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .quiz-container {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            margin: 2rem 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .quiz-question {
            margin-bottom: 1.5rem;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .quiz-option {
            padding: 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-option:hover {
            border-color: var(--primary);
            background: var(--light);
        }

        .quiz-option.correct {
            border-color: var(--success);
            background: #E8F5E8;
        }

        .quiz-option.incorrect {
            border-color: var(--warning);
            background: #FFEBEE;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            header h1 {
                font-size: 2rem;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 300px;
            background: var(--dark);
            color: white;
            text-align: left;
            border-radius: 6px;
            padding: 1rem;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9rem;
            font-weight: normal;
            line-height: 1.4;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <h1>üéì Lab VLSM - Plateforme P√©dagogique</h1>
                <p class="subtitle">Comprenez le sous-r√©seautage IP gr√¢ce √† des exercices pratiques et interactifs</p>
                <div>
                    <span class="badge">üìö Niveau: D√©butant √† Avanc√©</span>
                    <span class="badge">‚è±Ô∏è Dur√©e: 2-4 heures</span>
                    <span class="badge">üéØ Objectif: Ma√Ætriser le VLSM</span>
                </div>
            </div>
        </header>

        <nav class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('theory')">
                üìö Th√©orie
            </button>
            <button class="nav-tab" onclick="showTab('lab')">
                üî¨ Laboratoire
            </button>
            <button class="nav-tab" onclick="showTab('calculation')">
                üßÆ Calcul VLSM
            </button>
            <button class="nav-tab" onclick="showTab('routing')">
                üö¶ Routage
            </button>
            <button class="nav-tab" onclick="showTab('quiz')">
                ‚úÖ √âvaluation
            </button>
        </nav>

        <!-- Section Th√©orie -->
        <section id="theory" class="tab-content active">
            <h2>üìö Fondamentaux du VLSM</h2>
            
            <div class="learning-objective">
                <h3>üéØ Objectifs d'Apprentissage</h3>
                <p>√Ä la fin de cette section, vous serez capable de:</p>
                <ul>
                    <li>Comprendre la diff√©rence entre sous-r√©seautage classique et VLSM</li>
                    <li>Convertir des adresses IP entre notation d√©cimale et binaire</li>
                    <li>Calculer des masques de sous-r√©seau variables</li>
                    <li>Optimiser l'allocation d'adresses IP</li>
                </ul>
            </div>

            <div class="concept-explanation">
                <h3>üîç Qu'est-ce que le VLSM?</h3>
                <p>Le <strong>Variable Length Subnet Mask</strong> (VLSM) permet de cr√©er des sous-r√©seaux de tailles diff√©rentes au sein d'un m√™me r√©seau principal.</p>
                
                <div class="form-grid">
                    <div class="input-group">
                        <h4>üîÑ Comparaison Classique vs VLSM</h4>
                        <p><strong>Sous-r√©seautage classique:</strong> Tous les sous-r√©seaux ont la m√™me taille</p>
                        <p><strong>VLSM:</strong> Chaque sous-r√©seau a une taille adapt√©e √† ses besoins</p>
                    </div>
                    <div class="input-group">
                        <h4>üí∞ Avantages du VLSM</h4>
                        <ul>
                            <li>√âconomie d'adresses IP</li>
                            <li>Flexibilit√© d'allocation</li>
                            <li>Optimisation des ressources</li>
                            <li>Meilleure scalabilit√©</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="binary-tutorial">
                <h3>üî¢ Comprendre le Binaire</h3>
                <p>L'adressage IP est bas√© sur le syst√®me binaire. Voici comment convertir:</p>
                
                <div class="bits-container">
                    <div style="text-align: center; margin-bottom: 1rem;">
                        <strong>192.168.1.0</strong> en binaire:
                    </div>
                    <div class="bit bit-1">1</div><div class="bit bit-1">1</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div>
                    <div style="width: 20px; text-align: center;">.</div>
                    <div class="bit bit-1">1</div><div class="bit bit-0">0</div><div class="bit bit-1">1</div><div class="bit bit-0">0</div><div class="bit bit-1">1</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div>
                    <div style="width: 20px; text-align: center;">.</div>
                    <div class="bit bit-0">0</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div><div class="bit bit-1">1</div>
                    <div style="width: 20px; text-align: center;">.</div>
                    <div class="bit bit-0">0</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div><div class="bit bit-0">0</div>
                </div>

                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: var(--success);"></div>
                        <span>Bit √† 1 (Valeur)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: var(--border);"></div>
                        <span>Bit √† 0 (Pas de valeur)</span>
                    </div>
                </div>
            </div>

            <div class="exercise-grid">
                <div class="exercise-card">
                    <h4>üìù Exercice 1: Conversion Binaire
                        <span class="difficulty-badge difficulty-easy">Facile</span>
                    </h4>
                    <p>Convertissez l'adresse IP 172.16.32.0 en notation binaire.</p>
                    <div class="button-group">
                        <button class="btn btn-secondary" onclick="showSolution(1)">Voir la Solution</button>
                    </div>
                    <div id="solution1" style="display: none; margin-top: 1rem; padding: 1rem; background: var(--light); border-radius: 8px;">
                        <strong>Solution:</strong> 10101100.00010000.00100000.00000000
                    </div>
                </div>

                <div class="exercise-card">
                    <h4>üéØ Exercice 2: Masque de Sous-R√©seau
                        <span class="difficulty-badge difficulty-medium">Moyen</span>
                    </h4>
                    <p>Quel est le masque CIDR pour un sous-r√©seau de 30 h√¥tes?</p>
                    <div class="button-group">
                        <button class="btn btn-secondary" onclick="showSolution(2)">Voir la Solution</button>
                    </div>
                    <div id="solution2" style="display: none; margin-top: 1rem; padding: 1rem; background: var(--light); border-radius: 8px;">
                        <strong>Solution:</strong> /27 (32 adresses totales, 30 h√¥tes utilisables)
                    </div>
                </div>
            </div>
        </section>

        <!-- Section Laboratoire -->
        <section id="lab" class="tab-content">
            <h2>üî¨ Laboratoire Pratique</h2>
            
            <div class="learning-objective">
                <h3>üéØ Sc√©nario d'Entreprise</h3>
                <p>Vous √™tes l'administrateur r√©seau d'une entreprise qui doit segmenter son r√©seau en 4 d√©partements avec des besoins diff√©rents.</p>
            </div>

            <div class="form-grid">
                <div class="input-group">
                    <label for="network">
                        üåê Adresse R√©seau Principal
                        <span class="tooltip">‚ÑπÔ∏è
                            <span class="tooltip-text">Adresse IP du r√©seau √† segmenter. Exemple: 192.168.0.0/22 permet 1024 adresses totales.</span>
                        </span>
                    </label>
                    <input type="text" id="network" placeholder="192.168.0.0" value="192.168.0.0">
                </div>

                <div class="input-group">
                    <label for="mask">
                        üé≠ Masque CIDR Initial
                        <span class="tooltip">‚ÑπÔ∏è
                            <span class="tooltip-text">Le masque d√©finit la taille du r√©seau principal. /22 = 1024 adresses, /24 = 256 adresses.</span>
                        </span>
                    </label>
                    <input type="text" id="mask" placeholder="/22" value="/22">
                </div>

                <div class="input-group">
                    <label for="subnetCount">
                        üè¢ Nombre de D√©partements
                        <span class="tooltip">‚ÑπÔ∏è
                            <span class="tooltip-text">Chaque d√©partement aura son propre sous-r√©seau avec une taille adapt√©e √† ses besoins.</span>
                        </span>
                    </label>
                    <input type="number" id="subnetCount" min="1" max="8" value="4">
                </div>
            </div>

            <div id="departmentInputs"></div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="generateDepartmentInputs()">
                    üöÄ Configurer les D√©partements
                </button>
                <button class="btn btn-secondary" onclick="loadEducationalExample()">
                    üìã Exemple P√©dagogique
                </button>
                <button class="btn btn-primary" onclick="calculateVLSM()">
                    üßÆ Lancer le Calcul VLSM
                </button>
            </div>

            <div class="concept-explanation">
                <h3>üí° Conseils pour le Laboratoire</h3>
                <div class="tip-item">
                    <span class="tip-icon">üî¢</span>
                    <div>
                        <strong>Commencez par les plus grands sous-r√©seaux:</strong> Allouez d'abord les sous-r√©seaux avec le plus d'h√¥tes.
                    </div>
                </div>
                <div class="tip-item">
                    <span class="tip-icon">üìà</span>
                    <div>
                        <strong>Pr√©voyez la croissance:</strong> Ajoutez 20% d'adresses suppl√©mentaires pour l'expansion future.
                    </div>
                </div>
                <div class="tip-item">
                    <span class="tip-icon">üõ°Ô∏è</span>
                    <div>
                        <strong>Pensez s√©curit√©:</strong> Isolez les d√©partements sensibles dans des sous-r√©seaux s√©par√©s.
                    </div>
                </div>
            </div>
        </section>

        <!-- Section Calcul VLSM -->
        <section id="calculation" class="tab-content">
            <h2>üßÆ Calcul VLSM Pas √† Pas</h2>
            
            <div class="binary-tutorial">
                <h3>üî¢ Analyse Binaire du R√©seau</h3>
                <div id="binaryAnalysis"></div>
            </div>

            <div id="stepByStepCalculation"></div>

            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-number" id="totalHosts">0</span>
                    <span class="stat-label">H√¥tes Demand√©s</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="totalAllocated">0</span>
                    <span class="stat-label">H√¥tes Allou√©s</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="efficiency">0%</span>
                    <span class="stat-label">Efficacit√©</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="savings">0</span>
                    <span class="stat-label">Adresses √âconomis√©es</span>
                </div>
            </div>

            <div class="table-responsive">
                <table>
                    <thead>
                        <tr>
                            <th>D√©partement</th>
                            <th>R√©seau</th>
                            <th>Masque</th>
                            <th>H√¥tes</th>
                            <th>Plage Utilisable</th>
                            <th>Broadcast</th>
                        </tr>
                    </thead>
                    <tbody id="resultsBody"></tbody>
                </table>
            </div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="showTab('routing')">
                    üö¶ Passer au Routage
                </button>
                <button class="btn btn-secondary" onclick="showTab('lab')">
                    ‚¨ÖÔ∏è Modifier la Configuration
                </button>
            </div>
        </section>

        <!-- Section Routage -->
        <section id="routing" class="tab-content">
            <h2>üö¶ Configuration des √âquipements R√©seau</h2>
            
            <div class="learning-objective">
                <h3>üéØ Mise en Pratique R√©elle</h3>
                <p>Apprenez √† configurer les routeurs et switches pour impl√©menter votre plan VLSM.</p>
            </div>

            <div class="config-tabs">
                <button class="config-tab active" onclick="showConfig('cisco')">üî∑ Cisco IOS</button>
                <button class="config-tab" onclick="showConfig('cisco-basic')">üî∑ Cisco D√©butant</button>
                <button class="config-tab" onclick="showConfig('hp')">üî∂ HP ProCurve</button>
                <button class="config-tab" onclick="showConfig('theory')">üìö Concepts</button>
            </div>

            <div id="cisco-config" class="config-content">
                <h3>üî∑ Configuration Cisco IOS Avanc√©e</h3>
                <div class="config-code" id="ciscoCode"></div>
            </div>

            <div id="cisco-basic-config" class="config-content" style="display: none;">
                <h3>üî∑ Cisco pour D√©butants</h3>
                <div class="config-code" id="ciscoBasicCode"></div>
            </div>

            <div id="hp-config" class="config-content" style="display: none;">
                <h3>üî∂ Configuration HP ProCurve</h3>
                <div class="config-code" id="hpCode"></div>
            </div>

            <div id="theory-config" class="config-content" style="display: none;">
                <h3>üìö Concepts de Routage Inter-VLAN</h3>
                <div class="concept-explanation">
                    <h4>üéØ Router-on-a-Stick</h4>
                    <p>Cette architecture utilise une interface physique unique avec des sous-interfaces pour router entre les VLANs.</p>
                    
                    <h4>üîß Composants Cl√©s</h4>
                    <ul>
                        <li><strong>Interface Trunk:</strong> Port transportant multiple VLANs</li>
                        <li><strong>Subinterfaces:</strong> Interfaces logiques par VLAN</li>
                        <li><strong>802.1Q:</strong> Protocole de trunking standard</li>
                    </ul>
                </div>
            </div>

            <div class="exercise-grid">
                <div class="exercise-card">
                    <h4>üíª Exercice de Configuration
                        <span class="difficulty-badge difficulty-medium">Moyen</span>
                    </h4>
                    <p>Configurez le VLAN 10 sur un switch Cisco avec l'adresse 192.168.1.1/24</p>
                    <div class="button-group">
                        <button class="btn btn-secondary" onclick="showConfigSolution()">Voir la Solution</button>
                    </div>
                    <div id="configSolution" style="display: none; margin-top: 1rem; padding: 1rem; background: var(--light); border-radius: 8px;">
                        <pre>
Switch> enable
Switch# configure terminal
Switch(config)# vlan 10
Switch(config-vlan)# name Administration
Switch(config-vlan)# exit
Switch(config)# interface vlan 10
Switch(config-if)# ip address 192.168.1.1 255.255.255.0
Switch(config-if)# no shutdown
Switch(config-if)# exit
Switch(config)# write memory
                        </pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section √âvaluation -->
        <section id="quiz" class="tab-content">
            <h2>‚úÖ √âvaluation des Connaissances</h2>
            
            <div class="quiz-container">
                <div class="quiz-question">
                    <h3>Question 1: Conversion Binaire</h3>
                    <p>Quelle est la repr√©sentation binaire de l'adresse IP 192.168.1.0?</p>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="checkAnswer(this, 'correct')">
                            11000000.10101000.00000001.00000000
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">
                            11000000.10101000.00000010.00000000
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">
                            11000000.10101001.00000001.00000000
                        </div>
                    </div>
                </div>

                <div class="quiz-question">
                    <h3>Question 2: Calcul VLSM</h3>
                    <p>Vous avez besoin d'un sous-r√©seau pour 14 h√¥tes. Quel masque CIDR devez-vous utiliser?</p>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">/26</div>
                        <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">/25</div>
                        <div class="quiz-option" onclick="checkAnswer(this, 'correct')">/28</div>
                        <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">/27</div>
                    </div>
                </div>

                <div class="quiz-question">
                    <h3>Question 3: Configuration Routeur</h3>
                    <p>Quelle commande Cisco permet de cr√©er une sous-interface pour le VLAN 10?</p>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="checkAnswer(this, 'correct')">
                            interface gigabitethernet0/0.10
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">
                            vlan interface 10
                        </div>
                        <div class="quiz-option" onclick="checkAnswer(this, 'incorrect')">
                            subinterface vlan 10
                        </div>
                    </div>
                </div>
            </div>

            <div class="concept-explanation">
                <h3>üìä R√©sultats d'Apprentissage</h3>
                <p>F√©licitations! Vous avez compl√©t√© cette plateforme d'apprentissage VLSM. Continuez √† pratiquer pour ma√Ætriser ces concepts essentiels en r√©seaux.</p>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-number" id="quizScore">0%</span>
                        <span class="stat-label">Score au Quiz</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number" id="conceptsMastered">0</span>
                        <span class="stat-label">Concepts Ma√Ætris√©s</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number" id="timeSpent">0min</span>
                        <span class="stat-label">Temps d'√âtude</span>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script>
        // √âtat global de l'application
        const AppState = {
            departments: [],
            results: [],
            quizScore: 0,
            startTime: new Date(),
            currentTab: 'theory',
            
            init() {
                this.loadFromStorage();
                this.updateLearningStats();
                this.showTab('theory');
            },
            
            saveToStorage() {
                const state = {
                    network: document.getElementById('network').value,
                    mask: document.getElementById('mask').value,
                    subnetCount: document.getElementById('subnetCount').value,
                    departments: this.departments,
                    quizScore: this.quizScore
                };
                localStorage.setItem('vlsm-learning-platform', JSON.stringify(state));
            },
            
            loadFromStorage() {
                const saved = localStorage.getItem('vlsm-learning-platform');
                if (saved) {
                    const state = JSON.parse(saved);
                    document.getElementById('network').value = state.network || '192.168.0.0';
                    document.getElementById('mask').value = state.mask || '/22';
                    document.getElementById('subnetCount').value = state.subnetCount || 4;
                    this.departments = state.departments || [];
                    this.quizScore = state.quizScore || 0;
                    
                    if (this.departments.length > 0) {
                        this.generateDepartmentInputs();
                    }
                }
            },
            
            updateLearningStats() {
                const timeSpent = Math.round((new Date() - this.startTime) / 60000);
                document.getElementById('timeSpent').textContent = timeSpent + 'min';
                document.getElementById('quizScore').textContent = this.quizScore + '%';
                document.getElementById('conceptsMastered').textContent = this.departments.length;
            },
            
            addDepartment(department) {
                this.departments.push(department);
                this.saveToStorage();
            },
            
            updateDepartment(index, field, value) {
                if (this.departments[index]) {
                    this.departments[index][field] = value;
                    this.saveToStorage();
                }
            }
        };

        // Templates de d√©partements p√©dagogiques
        const DepartmentTemplates = {
            administration: { 
                name: "Administration", 
                hosts: 50, 
                vlan: 10,
                description: "Services administratifs et gestion",
                color: "#2E7D32"
            },
            production: { 
                name: "Production", 
                hosts: 120, 
                vlan: 20,
                description: "Atelier et ligne de production",
                color: "#1565C0"
            },
            commercial: { 
                name: "Commercial", 
                hosts: 30, 
                vlan: 30,
                description: "√âquipe commerciale et marketing",
                color: "#FF6D00"
            },
            recherche: { 
                name: "R&D", 
                hosts: 25, 
                vlan: 40,
                description: "Laboratoire R&D",
                color: "#6A1B9A"
            }
        };

        // Fonctions principales
        function showTab(tabId) {
            // Masquer tous les onglets
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Activer l'onglet s√©lectionn√©
            event.target.classList.add('active');
            document.getElementById(tabId).classList.add('active');
            AppState.currentTab = tabId;
            
            // Mettre √† jour les contenus dynamiques
            if (tabId === 'calculation' && AppState.results.length > 0) {
                updateBinaryAnalysis();
                updateStepByStepCalculation();
            }
        }

        function showConfig(vendor) {
            document.querySelectorAll('.config-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.config-content').forEach(content => {
                content.style.display = 'none';
            });
            
            event.target.classList.add('active');
            document.getElementById(`${vendor}-config`).style.display = 'block';
            
            if (AppState.results.length > 0) {
                generateRouterConfigs();
            }
        }

        function generateDepartmentInputs() {
            const subnetCount = parseInt(document.getElementById('subnetCount').value);
            const container = document.getElementById('departmentInputs');
            
            if (isNaN(subnetCount) || subnetCount < 1) {
                alert('Veuillez entrer un nombre valide de d√©partements');
                return;
            }
            
            let html = '<h3>üè¢ Configuration des D√©partements</h3><div class="form-grid">';
            const templateKeys = Object.keys(DepartmentTemplates);
            
            for (let i = 0; i < subnetCount; i++) {
                const template = DepartmentTemplates[templateKeys[i % templateKeys.length]];
                
                html += `
                    <div class="input-group">
                        <label>D√©partement ${i + 1} - VLAN ${template.vlan + i}</label>
                        <input type="text" 
                               value="${template.name}" 
                               onchange="updateDepartment(${i}, 'name', this.value)"
                               placeholder="Nom du d√©partement">
                        <input type="number" 
                               value="${template.hosts}" 
                               onchange="updateDepartment(${i}, 'hosts', parseInt(this.value))"
                               min="1" 
                               placeholder="Nombre d'h√¥tes">
                        <select onchange="applyTemplate(${i}, this.value)">
                            <option value="">Choisir un mod√®le</option>
                            ${Object.keys(DepartmentTemplates).map(key => 
                                `<option value="${key}" ${key === templateKeys[i % templateKeys.length] ? 'selected' : ''}>
                                    ${DepartmentTemplates[key].name} (VLAN ${DepartmentTemplates[key].vlan})
                                </option>`
                            ).join('')}
                        </select>
                        <small>${template.description}</small>
                    </div>
                `;
                
                if (!AppState.departments[i]) {
                    AppState.departments[i] = { 
                        ...template,
                        vlan: template.vlan + i
                    };
                }
            }
            
            html += '</div>';
            container.innerHTML = html;
            AppState.saveToStorage();
        }

        function updateDepartment(index, field, value) {
            AppState.updateDepartment(index, field, value);
        }

        function applyTemplate(index, templateKey) {
            if (DepartmentTemplates[templateKey]) {
                AppState.departments[index] = { 
                    ...DepartmentTemplates[templateKey],
                    vlan: DepartmentTemplates[templateKey].vlan + index
                };
                generateDepartmentInputs();
            }
        }

        // Fonctions de calcul VLSM
        function ipToInt(ip) {
            return ip.split('.').reduce((acc, octet) => (acc << 8) + parseInt(octet), 0) >>> 0;
        }

        function intToIp(int) {
            return [(int >>> 24) & 255, (int >>> 16) & 255, (int >>> 8) & 255, int & 255].join('.');
        }

        function ipToBinary(ip) {
            return ip.split('.').map(octet => 
                parseInt(octet).toString(2).padStart(8, '0')
            ).join('');
        }

        function maskToPrefix(mask) {
            if (mask.startsWith('/')) {
                return parseInt(mask.slice(1));
            }
            const parts = mask.split('.').map(Number);
            const binary = parts.map(part => part.toString(2).padStart(8, '0')).join('');
            return binary.indexOf('0');
        }

        function calculateVLSM() {
            const network = document.getElementById('network').value;
            const mask = document.getElementById('mask').value;
            
            if (!network || !mask || AppState.departments.length === 0) {
                alert('Veuillez compl√©ter la configuration des d√©partements');
                return;
            }
            
            const prefix = maskToPrefix(mask);
            const networkInt = ipToInt(network);
            const totalSize = Math.pow(2, 32 - prefix);
            
            // Trier par nombre d'h√¥tes d√©croissant
            const sortedDepartments = [...AppState.departments].sort((a, b) => b.hosts - a.hosts);
            
            let currentAddress = networkInt;
            AppState.results = [];
            let totalRequested = 0;
            let totalAllocated = 0;
            
            for (let i = 0; i < sortedDepartments.length; i++) {
                const dept = sortedDepartments[i];
                const neededAddresses = dept.hosts + 2;
                const newPrefix = 32 - Math.ceil(Math.log2(neededAddresses));
                const subnetSize = Math.pow(2, 32 - newPrefix);
                
                const networkAddr = currentAddress;
                const firstUsable = networkAddr + 1;
                const lastUsable = networkAddr + subnetSize - 2;
                const broadcastAddr = networkAddr + subnetSize - 1;
                
                AppState.results.push({
                    name: dept.name,
                    vlan: dept.vlan,
                    network: intToIp(networkAddr),
                    prefix: newPrefix,
                    hosts: subnetSize - 2,
                    firstIP: intToIp(firstUsable),
                    lastIP: intToIp(lastUsable),
                    broadcast: intToIp(broadcastAddr),
                    color: dept.color,
                    requested: dept.hosts,
                    description: dept.description
                });
                
                totalRequested += dept.hosts;
                totalAllocated += subnetSize - 2;
                currentAddress += subnetSize;
            }
            
            // Trier par VLAN
            AppState.results.sort((a, b) => a.vlan - b.vlan);
            
            displayResults(totalRequested, totalAllocated);
            showTab('calculation');
        }

        function displayResults(totalRequested, totalAllocated) {
            // Mettre √† jour les statistiques
            document.getElementById('totalHosts').textContent = totalRequested;
            document.getElementById('totalAllocated').textContent = totalAllocated;
            
            const efficiency = totalAllocated > 0 ? Math.round((totalRequested / totalAllocated) * 100) : 0;
            document.getElementById('efficiency').textContent = efficiency + '%';
            document.getElementById('savings').textContent = Math.max(0, totalAllocated - totalRequested);
            
            // Mettre √† jour le tableau
            const tbody = document.getElementById('resultsBody');
            tbody.innerHTML = AppState.results.map(result => `
                <tr>
                    <td><strong>${result.name}</strong><br><small>VLAN ${result.vlan}</small></td>
                    <td>${result.network}</td>
                    <td>/${result.prefix}</td>
                    <td>${result.requested}/${result.hosts}</td>
                    <td>${result.firstIP} - ${result.lastIP}</td>
                    <td>${result.broadcast}</td>
                </tr>
            `).join('');
            
            updateBinaryAnalysis();
            updateStepByStepCalculation();
            generateRouterConfigs();
            AppState.updateLearningStats();
        }

        function updateBinaryAnalysis() {
            const network = document.getElementById('network').value;
            const prefix = maskToPrefix(document.getElementById('mask').value);
            const binaryNetwork = ipToBinary(network);
            
            let html = `
                <div style="margin-bottom: 1rem;">
                    <strong>R√©seau Principal:</strong> ${network}/${prefix}
                </div>
                <div class="bits-container">
            `;
            
            for (let i = 0; i < 32; i++) {
                let bitClass = 'bit';
                const bitValue = binaryNetwork[i];
                
                if (i < prefix) {
                    bitClass += ' bit-network';
                } else {
                    bitClass += ' bit-host';
                }
                
                if (bitValue === '1') {
                    bitClass += ' bit-1';
                } else {
                    bitClass += ' bit-0';
                }
                
                html += `<div class="${bitClass}" title="Bit ${i}: ${i < prefix ? 'R√©seau' : 'H√¥te'}">${bitValue}</div>`;
                
                if ((i + 1) % 8 === 0 && i < 31) {
                    html += '<div style="width: 20px; text-align: center;">.</div>';
                }
            }
            
            html += `</div>`;
            document.getElementById('binaryAnalysis').innerHTML = html;
        }

        function updateStepByStepCalculation() {
            const container = document.getElementById('stepByStepCalculation');
            let html = '<h3>üìù √âtapes de Calcul</h3>';
            
            AppState.results.forEach((result, index) => {
                html += `
                    <div class="concept-explanation">
                        <h4>√âtape ${index + 1}: ${result.name}</h4>
                        <p><strong>H√¥tes demand√©s:</strong> ${result.requested}</p>
                        <p><strong>Adresses n√©cessaires:</strong> ${result.requested} + 2 = ${result.requested + 2}</p>
                        <p><strong>Nouveau pr√©fixe:</strong> 32 - ‚åàlog‚ÇÇ(${result.requested + 2})‚åâ = /${result.prefix}</p>
                        <p><strong>Taille du sous-r√©seau:</strong> 2<sup>${32 - result.prefix}</sup> = ${Math.pow(2, 32 - result.prefix)} adresses</p>
                        <p><strong>H√¥tes utilisables:</strong> ${Math.pow(2, 32 - result.prefix)} - 2 = ${result.hosts}</p>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function generateRouterConfigs() {
            generateCiscoConfig();
            generateCiscoBasicConfig();
            generateHPConfig();
        }

        function generateCiscoConfig() {
            let config = `<span class="config-comment">! Configuration Cisco IOS - Routeur Principal</span>\n`;
            config += `<span class="config-keyword">enable</span>\n`;
            config += `<span class="config-keyword">configure terminal</span>\n\n`;
            
            config += `<span class="config-comment">! Configuration des VLANs</span>\n`;
            AppState.results.forEach(result => {
                config += `<span class="config-keyword">vlan</span> <span class="config-number">${result.vlan}</span>\n`;
                config += `<span class="config-keyword"> name</span> <span class="config-string">${result.name}</span>\n`;
                config += `<span class="config-keyword"> exit</span>\n`;
            });
            
            config += `\n<span class="config-comment">! Configuration des interfaces VLAN</span>\n`;
            AppState.results.forEach(result => {
                config += `<span class="config-keyword">interface vlan</span> <span class="config-number">${result.vlan}</span>\n`;
                config += `<span class="config-keyword"> description</span> <span class="config-string">Gateway ${result.name}</span>\n`;
                config += `<span class="config-keyword"> ip address</span> <span class="config-number">${result.firstIP}</span> <span class="config-number">${result.prefix}</span>\n`;
                config += `<span class="config-keyword"> no shutdown</span>\n`;
                config += `<span class="config-keyword"> exit</span>\n`;
            });
            
            document.getElementById('ciscoCode').innerHTML = config;
        }

        function generateCiscoBasicConfig() {
            let config = `<span class="config-comment">! CONFIGURATION CISCO POUR D√âBUTANTS</span>\n\n`;
            config += `<span class="config-comment">! Commandes de base √† conna√Ætre:</span>\n`;
            config += `<span class="config-keyword">enable</span> <span class="config-comment"># Passer en mode privil√©gi√©</span>\n`;
            config += `<span class="config-keyword">configure terminal</span> <span class="config-comment"># Mode configuration</span>\n\n`;
            
            config += `<span class="config-comment">! Exemple pour le VLAN 10:</span>\n`;
            config += `<span class="config-keyword">vlan 10</span>\n`;
            config += `<span class="config-keyword"> name ADMINISTRATION</span>\n`;
            config += `<span class="config-keyword">interface vlan 10</span>\n`;
            config += `<span class="config-keyword"> ip address 192.168.1.1 255.255.255.0</span>\n`;
            config += `<span class="config-keyword"> no shutdown</span>\n`;
            config += `<span class="config-keyword"> exit</span>\n\n`;
            
            config += `<span class="config-comment">! NE PAS OUBLIER:</span>\n`;
            config += `<span class="config-keyword">write memory</span> <span class="config-comment"># Sauvegarder!</span>\n`;
            
            document.getElementById('ciscoBasicCode').innerHTML = config;
        }

        function generateHPConfig() {
            let config = `<span class="config-comment"># Configuration HP ProCurve</span>\n\n`;
            
            config += `<span class="config-comment"># Configuration des VLANs</span>\n`;
            AppState.results.forEach(result => {
                config += `<span class="config-keyword">vlan</span> <span class="config-number">${result.vlan}</span>\n`;
                config += `<span class="config-keyword"> name</span> "<span class="config-string">${result.name}</span>"\n`;
            });
            
            config += `\n<span class="config-comment"># Configuration des adresses IP</span>\n`;
            AppState.results.forEach(result => {
                config += `<span class="config-keyword">ip address</span> <span class="config-number">${result.firstIP}</span>/<span class="config-number">${result.prefix}</span> <span class="config-keyword">vlan</span> <span class="config-number">${result.vlan}</span>\n`;
            });
            
            document.getElementById('hpCode').innerHTML = config;
        }

        // Fonctions p√©dagogiques
        function showSolution(exerciseNum) {
            const solution = document.getElementById(`solution${exerciseNum}`);
            if (solution.style.display === 'none') {
                solution.style.display = 'block';
            } else {
                solution.style.display = 'none';
            }
        }

        function showConfigSolution() {
            const solution = document.getElementById('configSolution');
            if (solution.style.display === 'none') {
                solution.style.display = 'block';
            } else {
                solution.style.display = 'none';
            }
        }

        function checkAnswer(element, result) {
            // R√©initialiser les autres options
            element.parentElement.querySelectorAll('.quiz-option').forEach(opt => {
                opt.classList.remove('correct', 'incorrect');
            });
            
            // Marquer la r√©ponse
            element.classList.add(result);
            
            if (result === 'correct') {
                AppState.quizScore = Math.min(100, AppState.quizScore + 33);
                AppState.updateLearningStats();
            }
        }

        function loadEducationalExample() {
            document.getElementById('network').value = '192.168.0.0';
            document.getElementById('mask').value = '/22';
            document.getElementById('subnetCount').value = 4;
            generateDepartmentInputs();
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            AppState.init();
            
            if (!localStorage.getItem('vlsm-learning-platform')) {
                setTimeout(loadEducationalExample, 500);
            }
        });
    </script>
</body>
</html>
