
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculateur VLSM Professionnel - Configuration Routeur</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --primary: #2E7D32;
            --secondary: #1565C0;
            --accent: #FF6D00;
            --warning: #D32F2F;
            --success: #388E3C;
            --info: #0277BD;
            --dark: #263238;
            --light: #F5F5F5;
            --border: #BDBDBD;
            --cisco: #049FD9;
            --hp: #0096D6;
            --junior: #FF9800;
            --senior: #4CAF50;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, var(--primary) 0%, #1B5E20 100%);
            color: white;
            padding: 2rem;
            text-align: center;
            border-radius: 15px;
            margin-bottom: 2rem;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255,255,255,0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255,255,255,0.1) 0%, transparent 50%);
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            position: relative;
        }

        .nav-tabs {
            display: flex;
            background: white;
            border-radius: 12px;
            padding: 10px;
            margin-bottom: 2rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            flex-wrap: wrap;
            gap: 5px;
        }

        .nav-tab {
            flex: 1;
            min-width: 150px;
            padding: 15px 20px;
            background: transparent;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: var(--dark);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .nav-tab:hover {
            background: var(--light);
            transform: translateY(-2px);
        }

        .nav-tab.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 12px rgba(46, 125, 50, 0.3);
        }

        .tab-content {
            display: none;
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
            animation: fadeIn 0.5s ease-in;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .input-group label {
            font-weight: 600;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .input-group input, .input-group select {
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.1);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: #1B5E20;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(46, 125, 50, 0.3);
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-secondary:hover {
            background: #0D47A1;
            transform: translateY(-2px);
        }

        .button-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin: 2rem 0;
        }

        /* Styles pour les configurations routeur */
        .router-configuration {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            margin: 2rem 0;
        }

        .vendor-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .vendor-tab {
            padding: 10px 20px;
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .vendor-tab.active {
            background: rgba(255,255,255,0.2);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .config-content {
            background: rgba(255,255,255,0.1);
            padding: 1.5rem;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .config-code {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            overflow-x: auto;
            margin: 1rem 0;
        }

        .config-comment {
            color: #6A9955;
        }

        .config-keyword {
            color: #569CD6;
        }

        .config-string {
            color: #CE9178;
        }

        .config-number {
            color: #B5CEA8;
        }

        .subnet-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .subnet-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-top: 4px solid var(--primary);
            transition: transform 0.3s ease;
        }

        .subnet-card:hover {
            transform: translateY(-5px);
        }

        .subnet-card h4 {
            color: var(--dark);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .table-responsive {
            overflow-x: auto;
            margin: 1.5rem 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: var(--light);
            font-weight: 600;
            color: var(--dark);
        }

        tr:hover {
            background: #f8f9fa;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-top: 4px solid var(--primary);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
            display: block;
        }

        .stat-label {
            color: var(--dark);
            font-size: 0.9rem;
        }

        .binary-explanation {
            background: var(--light);
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1.5rem 0;
            border-left: 4px solid var(--info);
        }

        .bits-container {
            display: flex;
            flex-wrap: wrap;
            gap: 3px;
            justify-content: center;
            margin: 1rem 0;
            padding: 1rem;
            background: white;
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .bit {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
            font-weight: bold;
            font-size: 0.8rem;
            position: relative;
        }

        .bit-network {
            background: var(--primary);
            color: white;
        }

        .bit-subnet {
            background: var(--secondary);
            color: white;
        }

        .bit-host {
            background: var(--accent);
            color: white;
        }

        .bit-1 {
            background: var(--success);
            color: white;
        }

        .bit-0 {
            background: var(--border);
            color: #666;
        }

        .expert-tips {
            background: linear-gradient(135deg, #FFEAA7 0%, #FFD43B 100%);
            padding: 1.5rem;
            border-radius: 10px;
            margin: 1.5rem 0;
            border-left: 4px solid var(--accent);
        }

        .tip-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 1rem;
        }

        .tip-item:last-child {
            margin-bottom: 0;
        }

        .tip-icon {
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            header h1 {
                font-size: 2rem;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 250px;
            background: var(--dark);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 0.5rem;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9rem;
            font-weight: normal;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üåê Calculateur VLSM Professionnel</h1>
            <p>Planification r√©seau avanc√©e avec configurations routeur Cisco et HP</p>
        </header>

        <nav class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('config')">
                ‚öôÔ∏è Configuration
            </button>
            <button class="nav-tab" onclick="showTab('calculation')">
                üßÆ Calcul VLSM
            </button>
            <button class="nav-tab" onclick="showTab('results')">
                üìä R√©sultats
            </button>
            <button class="nav-tab" onclick="showTab('routing')">
                üö¶ Routage
            </button>
            <button class="nav-tab" onclick="showTab('export')">
                üíæ Export
            </button>
        </nav>

        <!-- Section Configuration -->
        <section id="config" class="tab-content active">
            <h2>‚öôÔ∏è Configuration du R√©seau d'Entreprise</h2>
            
            <div class="form-grid">
                <div class="input-group">
                    <label for="network">
                        üåê Adresse R√©seau
                        <span class="tooltip">‚ÑπÔ∏è
                            <span class="tooltip-text">Adresse IP du r√©seau principal (ex: 192.168.0.0)</span>
                        </span>
                    </label>
                    <input type="text" id="network" placeholder="192.168.0.0" value="192.168.0.0">
                </div>

                <div class="input-group">
                    <label for="mask">
                        üé≠ Masque CIDR
                        <span class="tooltip">‚ÑπÔ∏è
                            <span class="tooltip-text">Masque de sous-r√©seau en notation CIDR (ex: /24)</span>
                        </span>
                    </label>
                    <input type="text" id="mask" placeholder="/24" value="/22">
                </div>

                <div class="input-group">
                    <label for="subnetCount">
                        üè¢ Nombre de D√©partements
                        <span class="tooltip">‚ÑπÔ∏è
                            <span class="tooltip-text">Nombre de sous-r√©seaux/VLANs n√©cessaires</span>
                        </span>
                    </label>
                    <input type="number" id="subnetCount" min="1" max="10" value="4">
                </div>
            </div>

            <div id="departmentInputs"></div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="generateDepartmentInputs()">
                    üöÄ G√©n√©rer les D√©partements
                </button>
                <button class="btn btn-secondary" onclick="loadExample()">
                    üìã Exemple Entreprise
                </button>
                <button class="btn btn-primary" onclick="calculateVLSM()">
                    üßÆ Calculer VLSM
                </button>
            </div>

            <div class="expert-tips">
                <h3>üí° Conseils de Planification R√©seau</h3>
                <div class="tip-item">
                    <span class="tip-icon">üî¢</span>
                    <div>
                        <strong>Planification VLAN:</strong> Assignez un VLAN ID par d√©partement (ex: VLAN 10 pour l'administration)
                    </div>
                </div>
                <div class="tip-item">
                    <span class="tip-icon">üìà</span>
                    <div>
                        <strong>Croissance future:</strong> R√©servez 20% d'adresses suppl√©mentaires pour l'expansion
                    </div>
                </div>
                <div class="tip-item">
                    <span class="tip-icon">üõ°Ô∏è</span>
                    <div>
                        <strong>S√©curit√©:</strong> Utilisez des ACLs pour isoler les d√©partements sensibles
                    </div>
                </div>
            </div>
        </section>

        <!-- Section Calcul -->
        <section id="calculation" class="tab-content">
            <h2>üßÆ Calcul VLSM D√©taill√©</h2>
            
            <div class="binary-explanation">
                <h3>üî¢ Analyse Binaire du R√©seau</h3>
                <div id="binaryAnalysis"></div>
            </div>

            <div class="subnet-grid" id="subnetCalculation"></div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="showTab('results')">
                    üìä Voir les R√©sultats
                </button>
                <button class="btn btn-secondary" onclick="showTab('config')">
                    ‚¨ÖÔ∏è Modifier Configuration
                </button>
            </div>
        </section>

        <!-- Section R√©sultats -->
        <section id="results" class="tab-content">
            <h2>üìä R√©sultats du Plan VLSM</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-number" id="totalHosts">0</span>
                    <span class="stat-label">H√¥tes Demand√©s</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="totalAllocated">0</span>
                    <span class="stat-label">H√¥tes Allou√©s</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="efficiency">0%</span>
                    <span class="stat-label">Efficacit√©</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number" id="savings">0</span>
                    <span class="stat-label">Adresses Sauvegard√©es</span>
                </div>
            </div>

            <div class="table-responsive">
                <table>
                    <thead>
                        <tr>
                            <th>VLAN</th>
                            <th>D√©partement</th>
                            <th>R√©seau</th>
                            <th>Masque</th>
                            <th>H√¥tes</th>
                            <th>Gateway</th>
                            <th>Plage Utilisable</th>
                            <th>Broadcast</th>
                        </tr>
                    </thead>
                    <tbody id="resultsBody"></tbody>
                </table>
            </div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="showTab('routing')">
                    üö¶ Configurations Routeur
                </button>
                <button class="btn btn-secondary" onclick="showTab('calculation')">
                    ‚¨ÖÔ∏è Voir les Calculs
                </button>
            </div>
        </section>

        <!-- Section Routage -->
        <section id="routing" class="tab-content">
            <h2>üö¶ Configuration Avanc√©e des Routeurs</h2>
            
            <div class="vendor-tabs">
                <button class="vendor-tab active" onclick="showVendorConfig('cisco')">üî∑ Cisco IOS</button>
                <button class="vendor-tab" onclick="showVendorConfig('hp')">üî∂ HP ProCurve</button>
                <button class="vendor-tab" onclick="showVendorConfig('junior')">üë®‚Äçüíº Technicien</button>
                <button class="vendor-tab" onclick="showVendorConfig('senior')">üë®‚Äçüíº Ing√©nieur</button>
            </div>

            <div id="cisco-config" class="config-content">
                <h3>üî∑ Configuration Cisco IOS</h3>
                <div class="config-code" id="ciscoCode"></div>
            </div>

            <div id="hp-config" class="config-content" style="display: none;">
                <h3>üî∂ Configuration HP ProCurve</h3>
                <div class="config-code" id="hpCode"></div>
            </div>

            <div id="junior-config" class="config-content" style="display: none;">
                <h3>üë®‚Äçüíº Configuration pour Technicien</h3>
                <div class="config-code" id="juniorCode"></div>
            </div>

            <div id="senior-config" class="config-content" style="display: none;">
                <h3>üë®‚Äçüíº Configuration pour Ing√©nieur</h3>
                <div class="config-code" id="seniorCode"></div>
            </div>

            <div class="expert-tips">
                <h3>üéØ Bonnes Pratiques de Configuration</h3>
                <div class="tip-item">
                    <span class="tip-icon">üîí</span>
                    <div>
                        <strong>S√©curit√©:</strong> Toujours configurer des mots de passe pour les modes enable et console
                    </div>
                </div>
                <div class="tip-item">
                    <span class="tip-icon">üìù</span>
                    <div>
                        <strong>Documentation:</strong> Ajouter des descriptions sur chaque interface et VLAN
                    </div>
                </div>
                <div class="tip-item">
                    <span class="tip-icon">üîÑ</span>
                    <div>
                        <strong>Sauvegarde:</strong> Sauvegarder la configuration apr√®s chaque modification
                    </div>
                </div>
            </div>
        </section>

        <!-- Section Export -->
        <section id="export" class="tab-content">
            <h2>üíæ Export Professionnel</h2>
            
            <div class="subnet-grid" id="exportCards"></div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="exportToExcel()">
                    üìä Excel Complet
                </button>
                <button class="btn btn-primary" onclick="exportToPDF()">
                    üìÑ PDF D√©taill√©
                </button>
                <button class="btn btn-secondary" onclick="showTab('routing')">
                    ‚¨ÖÔ∏è Configurations
                </button>
            </div>

            <div class="expert-tips">
                <h3>üìã Checklist de D√©ploiement</h3>
                <div class="tip-item">
                    <span class="tip-icon">‚úÖ</span>
                    <div>V√©rifier la connectivit√© physique entre les √©quipements</div>
                </div>
                <div class="tip-item">
                    <span class="tip-icon">‚úÖ</span>
                    <div>Tester la connectivit√© IP entre les VLANs</div>
                </div>
                <div class="tip-item">
                    <span class="tip-icon">‚úÖ</span>
                    <div>Valider les r√®gles de s√©curit√© et ACLs</div>
                </div>
                <div class="tip-item">
                    <span class="tip-icon">‚úÖ</span>
                    <div>Sauvegarder les configurations finales</div>
                </div>
            </div>
        </section>
    </div>

    <script>
        // √âtat global de l'application
        const AppState = {
            departments: [],
            results: [],
            
            init() {
                this.loadFromStorage();
            },
            
            saveToStorage() {
                const state = {
                    network: document.getElementById('network').value,
                    mask: document.getElementById('mask').value,
                    subnetCount: document.getElementById('subnetCount').value,
                    departments: this.departments
                };
                localStorage.setItem('vlsm-pro-calculator', JSON.stringify(state));
            },
            
            loadFromStorage() {
                const saved = localStorage.getItem('vlsm-pro-calculator');
                if (saved) {
                    const state = JSON.parse(saved);
                    document.getElementById('network').value = state.network || '192.168.0.0';
                    document.getElementById('mask').value = state.mask || '/22';
                    document.getElementById('subnetCount').value = state.subnetCount || 4;
                    this.departments = state.departments || [];
                    
                    if (this.departments.length > 0) {
                        this.generateDepartmentInputs();
                    }
                }
            }
        };

        // Templates de d√©partements professionnels
        const DepartmentTemplates = {
            administration: { 
                name: "Administration", 
                hosts: 50, 
                vlan: 10,
                description: "Services administratifs et gestion",
                critical: true 
            },
            production: { 
                name: "Production", 
                hosts: 120, 
                vlan: 20,
                description: "Atelier et ligne de production",
                critical: true 
            },
            commercial: { 
                name: "Commercial", 
                hosts: 30, 
                vlan: 30,
                description: "√âquipe commerciale et marketing",
                critical: false 
            },
            recherche: { 
                name: "R&D", 
                hosts: 25, 
                vlan: 40,
                description: "Laboratoire R&D",
                critical: true 
            },
            direction: { 
                name: "Direction", 
                hosts: 10, 
                vlan: 50,
                description: "Comit√© de direction",
                critical: true 
            },
            informatique: { 
                name: "Informatique", 
                hosts: 20, 
                vlan: 60,
                description: "Services IT et support",
                critical: true 
            }
        };

        // Fonctions principales
        function showTab(tabId) {
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            event.target.classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        function showVendorConfig(vendor) {
            document.querySelectorAll('.vendor-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.config-content').forEach(content => {
                content.style.display = 'none';
            });
            
            event.target.classList.add('active');
            document.getElementById(`${vendor}-config`).style.display = 'block';
            
            if (AppState.results.length > 0) {
                generateRouterConfigs();
            }
        }

        function generateDepartmentInputs() {
            const subnetCount = parseInt(document.getElementById('subnetCount').value);
            const container = document.getElementById('departmentInputs');
            
            if (isNaN(subnetCount) || subnetCount < 1) {
                alert('Veuillez entrer un nombre valide de d√©partements');
                return;
            }
            
            let html = '<h3>üè¢ Configuration des D√©partements</h3><div class="form-grid">';
            const templateKeys = Object.keys(DepartmentTemplates);
            
            for (let i = 0; i < subnetCount; i++) {
                const template = DepartmentTemplates[templateKeys[i % templateKeys.length]];
                
                html += `
                    <div class="input-group">
                        <label>D√©partement ${i + 1} - VLAN ${template.vlan + i}</label>
                        <input type="text" 
                               value="${template.name}" 
                               onchange="updateDepartment(${i}, 'name', this.value)"
                               placeholder="Nom du d√©partement">
                        <input type="number" 
                               value="${template.hosts}" 
                               onchange="updateDepartment(${i}, 'hosts', parseInt(this.value))"
                               min="1" 
                               placeholder="Nombre d'h√¥tes">
                        <select onchange="applyTemplate(${i}, this.value)">
                            <option value="">Choisir un mod√®le</option>
                            ${Object.keys(DepartmentTemplates).map(key => 
                                `<option value="${key}" ${key === templateKeys[i % templateKeys.length] ? 'selected' : ''}>
                                    ${DepartmentTemplates[key].name} (VLAN ${DepartmentTemplates[key].vlan})
                                </option>`
                            ).join('')}
                        </select>
                        <small>${template.description}</small>
                    </div>
                `;
                
                if (!AppState.departments[i]) {
                    AppState.departments[i] = { 
                        ...template,
                        vlan: template.vlan + i
                    };
                }
            }
            
            html += '</div>';
            container.innerHTML = html;
            AppState.saveToStorage();
        }

        function updateDepartment(index, field, value) {
            if (AppState.departments[index]) {
                AppState.departments[index][field] = value;
                AppState.saveToStorage();
            }
        }

        function applyTemplate(index, templateKey) {
            if (DepartmentTemplates[templateKey]) {
                AppState.departments[index] = { 
                    ...DepartmentTemplates[templateKey],
                    vlan: DepartmentTemplates[templateKey].vlan + index
                };
                generateDepartmentInputs();
            }
        }

        // Fonctions de calcul VLSM
        function ipToInt(ip) {
            return ip.split('.').reduce((acc, octet) => (acc << 8) + parseInt(octet), 0) >>> 0;
        }

        function intToIp(int) {
            return [(int >>> 24) & 255, (int >>> 16) & 255, (int >>> 8) & 255, int & 255].join('.');
        }

        function maskToPrefix(mask) {
            if (mask.startsWith('/')) {
                return parseInt(mask.slice(1));
            }
            const parts = mask.split('.').map(Number);
            const binary = parts.map(part => part.toString(2).padStart(8, '0')).join('');
            return binary.indexOf('0');
        }

        function calculateVLSM() {
            const network = document.getElementById('network').value;
            const mask = document.getElementById('mask').value;
            
            if (!network || !mask || AppState.departments.length === 0) {
                alert('Veuillez compl√©ter la configuration');
                return;
            }
            
            const prefix = maskToPrefix(mask);
            const networkInt = ipToInt(network);
            
            // Trier par nombre d'h√¥tes d√©croissant
            const sortedDepartments = [...AppState.departments].sort((a, b) => b.hosts - a.hosts);
            
            let currentAddress = networkInt;
            AppState.results = [];
            let totalRequested = 0;
            let totalAllocated = 0;
            
            for (let i = 0; i < sortedDepartments.length; i++) {
                const dept = sortedDepartments[i];
                const neededAddresses = dept.hosts + 2;
                const newPrefix = 32 - Math.ceil(Math.log2(neededAddresses));
                const subnetSize = Math.pow(2, 32 - newPrefix);
                
                const networkAddr = currentAddress;
                const firstUsable = networkAddr + 1;
                const lastUsable = networkAddr + subnetSize - 2;
                const broadcastAddr = networkAddr + subnetSize - 1;
                
                AppState.results.push({
                    name: dept.name,
                    vlan: dept.vlan,
                    network: intToIp(networkAddr),
                    prefix: newPrefix,
                    hosts: subnetSize - 2,
                    firstIP: intToIp(firstUsable),
                    lastIP: intToIp(lastUsable),
                    broadcast: intToIp(broadcastAddr),
                    requested: dept.hosts,
                    description: dept.description,
                    critical: dept.critical
                });
                
                totalRequested += dept.hosts;
                totalAllocated += subnetSize - 2;
                currentAddress += subnetSize;
            }
            
            // Trier par VLAN
            AppState.results.sort((a, b) => a.vlan - b.vlan);
            
            displayResults(totalRequested, totalAllocated);
            showTab('results');
        }

        function displayResults(totalRequested, totalAllocated) {
            // Statistiques
            document.getElementById('totalHosts').textContent = totalRequested;
            document.getElementById('totalAllocated').textContent = totalAllocated;
            
            const efficiency = Math.round((totalRequested / totalAllocated) * 100);
            document.getElementById('efficiency').textContent = efficiency + '%';
            document.getElementById('savings').textContent = totalAllocated - totalRequested;
            
            // Tableau des r√©sultats
            const tbody = document.getElementById('resultsBody');
            tbody.innerHTML = AppState.results.map(result => `
                <tr>
                    <td><strong>VLAN ${result.vlan}</strong></td>
                    <td>
                        <strong>${result.name}</strong>
                        <br><small>${result.description}</small>
                        ${result.critical ? '<br><span style="color: var(--warning);">üîí Critique</span>' : ''}
                    </td>
                    <td>${result.network}</td>
                    <td>/${result.prefix}</td>
                    <td>${result.requested}/${result.hosts}</td>
                    <td><strong>${result.firstIP}</strong></td>
                    <td>${result.firstIP} - ${result.lastIP}</td>
                    <td>${result.broadcast}</td>
                </tr>
            `).join('');
            
            updateBinaryAnalysis();
            generateRouterConfigs();
            updateExportCards();
        }

        function updateBinaryAnalysis() {
            const network = document.getElementById('network').value;
            const prefix = maskToPrefix(document.getElementById('mask').value);
            const binaryNetwork = network.split('.').map(octet => 
                parseInt(octet).toString(2).padStart(8, '0')
            ).join('');
            
            let html = `
                <div style="margin-bottom: 1rem;">
                    <strong>R√©seau Principal:</strong> ${network}/${prefix}
                </div>
                <div class="bits-container">
            `;
            
            for (let i = 0; i < 32; i++) {
                let bitClass = 'bit';
                const bitValue = binaryNetwork[i];
                
                if (i < prefix) {
                    bitClass += ' bit-network';
                } else {
                    bitClass += ' bit-host';
                }
                
                if (bitValue === '1') {
                    bitClass += ' bit-1';
                } else {
                    bitClass += ' bit-0';
                }
                
                html += `<div class="${bitClass}">${bitValue}</div>`;
                
                if ((i + 1) % 8 === 0 && i < 31) {
                    html += '<div style="width: 10px;"></div>';
                }
            }
            
            html += `</div>`;
            document.getElementById('binaryAnalysis').innerHTML = html;
        }

        function generateRouterConfigs() {
            generateCiscoConfig();
            generateHPConfig();
            generateJuniorConfig();
            generateSeniorConfig();
        }

        function generateCiscoConfig() {
            let config = `<span class="config-comment">! Configuration Cisco IOS - Routeur Principal</span>\n`;
            config += `<span class="config-keyword">enable</span>\n`;
            config += `<span class="config-keyword">configure terminal</span>\n\n`;
            
            config += `<span class="config-comment">! Configuration des VLANs</span>\n`;
            AppState.results.forEach(result => {
                config += `<span class="config-keyword">vlan</span> <span class="config-number">${result.vlan}</span>\n`;
                config += `<span class="config-keyword"> name</span> <span class="config-string">${result.name}</span>\n`;
                config += `<span class="config-keyword"> exit</span>\n`;
            });
            
            config += `\n<span class="config-comment">! Configuration des interfaces VLAN</span>\n`;
            AppState.results.forEach(result => {
                config += `<span class="config-keyword">interface vlan</span> <span class="config-number">${result.vlan}</span>\n`;
                config += `<span class="config-keyword"> description</span> <span class="config-string">Gateway ${result.name}</span>\n`;
                config += `<span class="config-keyword"> ip address</span> <span class="config-number">${result.firstIP}</span> <span class="config-number">${result.prefix}</span>\n`;
                config += `<span class="config-keyword"> no shutdown</span>\n`;
                config += `<span class="config-keyword"> exit</span>\n`;
            });
            
            config += `\n<span class="config-comment">! Configuration des ports trunk</span>\n`;
            config += `<span class="config-keyword">interface gigabitethernet0/1</span>\n`;
            config += `<span class="config-keyword"> description</span> <span class="config-string">Lien vers switch principal</span>\n`;
            config += `<span class="config-keyword"> switchport mode trunk</span>\n`;
            config += `<span class="config-keyword"> switchport trunk allowed vlan</span> <span class="config-number">${AppState.results.map(r => r.vlan).join(',')}</span>\n`;
            config += `<span class="config-keyword"> no shutdown</span>\n`;
            
            config += `\n<span class="config-comment">! Sauvegarde de la configuration</span>\n`;
            config += `<span class="config-keyword">write memory</span>\n`;
            
            document.getElementById('ciscoCode').innerHTML = config;
        }

        function generateHPConfig() {
            let config = `<span class="config-comment"># Configuration HP ProCurve - Switch Principal</span>\n\n`;
            
            config += `<span class="config-comment"># Configuration des VLANs</span>\n`;
            AppState.results.forEach(result => {
                config += `<span class="config-keyword">vlan</span> <span class="config-number">${result.vlan}</span>\n`;
                config += `<span class="config-keyword"> name</span> "<span class="config-string">${result.name}</span>"\n`;
            });
            
            config += `\n<span class="config-comment"># Configuration des adresses IP</span>\n`;
            AppState.results.forEach(result => {
                config += `<span class="config-keyword">ip address</span> <span class="config-number">${result.firstIP}</span>/<span class="config-number">${result.prefix}</span> <span class="config-keyword">vlan</span> <span class="config-number">${result.vlan}</span>\n`;
            });
            
            config += `\n<span class="config-comment"># Configuration des ports trunk</span>\n`;
            config += `<span class="config-keyword">interface</span> <span class="config-number">24</span>\n`;
            config += `<span class="config-keyword"> trunk</span> <span class="config-number">${AppState.results.map(r => r.vlan).join(' ')}</span> <span class="config-keyword">trunk</span>\n`;
            config += `<span class="config-keyword"> exit</span>\n`;
            
            config += `\n<span class="config-comment"># Activation du routage</span>\n`;
            config += `<span class="config-keyword">ip routing</span>\n`;
            
            config += `\n<span class="config-comment"># Sauvegarde de la configuration</span>\n`;
            config += `<span class="config-keyword">write memory</span>\n`;
            
            document.getElementById('hpCode').innerHTML = config;
        }

        function generateJuniorConfig() {
            let config = `<span class="config-comment"># CONFIGURATION SIMPLIFI√âE - POUR TECHNICIEN</span>\n\n`;
            config += `<span class="config-comment"># √âtapes de configuration de base:</span>\n`;
            config += `<span class="config-comment"># 1. Cr√©er les VLANs</span>\n`;
            config += `<span class="config-comment"># 2. Assigner les adresses IP</span>\n`;
            config += `<span class="config-comment"># 3. Configurer les ports trunk</span>\n\n`;
            
            config += `<span class="config-comment"># VLANs √† cr√©er:</span>\n`;
            AppState.results.forEach(result => {
                config += `<span class="config-comment"># VLAN ${result.vlan}: ${result.name} - ${result.network}/${result.prefix}</span>\n`;
            });
            
            config += `\n<span class="config-comment"># Commandes essentielles Cisco:</span>\n`;
            config += `<span class="config-keyword">enable</span>\n`;
            config += `<span class="config-keyword">configure terminal</span>\n`;
            config += `<span class="config-comment"># Pour chaque VLAN:</span>\n`;
            config += `<span class="config-keyword">vlan 10</span>\n`;
            config += `<span class="config-keyword"> name ADMINISTRATION</span>\n`;
            config += `<span class="config-keyword">interface vlan 10</span>\n`;
            config += `<span class="config-keyword"> ip address 192.168.1.1 255.255.255.0</span>\n`;
            config += `<span class="config-keyword"> no shutdown</span>\n`;
            
            config += `\n<span class="config-comment"># NE PAS OUBLIER:</span>\n`;
            config += `<span class="config-keyword">write memory</span> <span class="config-comment"># Sauvegarder!</span>\n`;
            
            document.getElementById('juniorCode').innerHTML = config;
        }

        function generateSeniorConfig() {
            let config = `<span class="config-comment">! CONFIGURATION AVANC√âE - POUR ING√âNIEUR</span>\n\n`;
            
            config += `<span class="config-comment">! Configuration globale</span>\n`;
            config += `<span class="config-keyword">hostname</span> <span class="config-string">CORP-CORE-ROUTER</span>\n`;
            config += `<span class="config-keyword">ip domain-name</span> <span class="config-string">entreprise.local</span>\n`;
            config += `<span class="config-keyword">crypto key generate rsa modulus 2048</span>\n\n`;
            
            config += `<span class="config-comment">! S√©curisation des acc√®s</span>\n`;
            config += `<span class="config-keyword">enable secret</span> <span class="config-string">$uper$3cur3P@ss</span>\n`;
            config += `<span class="config-keyword">username admin privilege 15 secret</span> <span class="config-string">Admin123!</span>\n`;
            config += `<span class="config-keyword">line console 0</span>\n`;
            config += `<span class="config-keyword"> login local</span>\n`;
            config += `<span class="config-keyword"> exec-timeout 5 0</span>\n`;
            config += `<span class="config-keyword">line vty 0 15</span>\n`;
            config += `<span class="config-keyword"> login local</span>\n`;
            config += `<span class="config-keyword"> transport input ssh</span>\n`;
            config += `<span class="config-keyword"> exit</span>\n\n`;
            
            config += `<span class="config-comment">! Configuration SNMP et monitoring</span>\n`;
            config += `<span class="config-keyword">snmp-server community</span> <span class="config-string">$tr0ngC0mmun1ty</span> <span class="config-keyword">RO</span>\n`;
            config += `<span class="config-keyword">snmp-server host</span> <span class="config-number">192.168.100.10</span> <span class="config-keyword">version 2c</span> <span class="config-string">monitoring</span>\n\n`;
            
            config += `<span class="config-comment">! Configuration des VLANs avec descriptions d√©taill√©es</span>\n`;
            AppState.results.forEach(result => {
                config += `<span class="config-keyword">vlan</span> <span class="config-number">${result.vlan}</span>\n`;
                config += `<span class="config-keyword"> name</span> <span class="config-string">${result.name.toUpperCase()}</span>\n`;
                config += `<span class="config-keyword"> description</span> <span class="config-string">${result.description} - Cr√©√© le ${new Date().toLocaleDateString()}</span>\n`;
                config += `<span class="config-keyword"> exit</span>\n`;
            });
            
            config += `\n<span class="config-comment">! Configuration des interfaces VLAN avec optimisation</span>\n`;
            AppState.results.forEach(result => {
                config += `<span class="config-keyword">interface Vlan</span><span class="config-number">${result.vlan}</span>\n`;
                config += `<span class="config-keyword"> description</span> <span class="config-string">Gateway for ${result.name} - VLAN ${result.vlan}</span>\n`;
                config += `<span class="config-keyword"> ip address</span> <span class="config-number">${result.firstIP}</span> <span class="config-number">${result.prefix}</span>\n`;
                config += `<span class="config-keyword"> ip helper-address</span> <span class="config-number">192.168.100.5</span> <span class="config-comment">! Serveur DHCP</span>\n`;
                if (result.critical) {
                    config += `<span class="config-keyword"> ip ospf priority</span> <span class="config-number">10</span> <span class="config-comment">! Priorit√© √©lev√©e pour VLAN critique</span>\n`;
                }
                config += `<span class="config-keyword"> no shutdown</span>\n`;
                config += `<span class="config-keyword"> exit</span>\n`;
            });
            
            config += `\n<span class="config-comment">! Configuration OSPF pour le routage interne</span>\n`;
            config += `<span class="config-keyword">router ospf 1</span>\n`;
            config += `<span class="config-keyword"> router-id</span> <span class="config-number">1.1.1.1</span>\n`;
            AppState.results.forEach(result => {
                config += `<span class="config-keyword"> network</span> <span class="config-number">${result.network}</span> <span class="config-number">0.0.0.${Math.pow(2, 32 - result.prefix) - 1}</span> <span class="config-keyword">area 0</span>\n`;
            });
            config += `<span class="config-keyword"> passive-interface default</span>\n`;
            config += `<span class="config-keyword"> no passive-interface GigabitEthernet0/0</span>\n`;
            config += `<span class="config-keyword"> exit</span>\n\n`;
            
            config += `<span class="config-comment">! ACLs de s√©curit√© par VLAN</span>\n`;
            config += `<span class="config-comment">! Restriction d'acc√®s au VLAN Administration</span>\n`;
            config += `<span class="config-keyword">ip access-list extended PROTECT-ADMIN-VLAN</span>\n`;
            config += `<span class="config-keyword"> permit ip</span> <span class="config-number">192.168.1.0</span> <span class="config-number">0.0.0.255</span> <span class="config-number">192.168.100.0</span> <span class="config-number">0.0.0.255</span>\n`;
            config += `<span class="config-keyword"> deny ip any any log</span>\n`;
            config += `<span class="config-keyword"> exit</span>\n\n`;
            
            config += `<span class="config-comment">! Quality of Service (QoS)</span>\n`;
            config += `<span class="config-keyword">class-map match-voice</span>\n`;
            config += `<span class="config-keyword"> match dscp ef</span>\n`;
            config += `<span class="config-keyword">class-map match-video</span>\n`;
            config += `<span class="config-keyword"> match dscp af41</span>\n`;
            config += `<span class="config-keyword">policy-map ENTERPRISE-QOS</span>\n`;
            config += `<span class="config-keyword"> class match-voice</span>\n`;
            config += `<span class="config-keyword">  priority percent 20</span>\n`;
            config += `<span class="config-keyword"> class match-video</span>\n`;
            config += `<span class="config-keyword">  bandwidth percent 15</span>\n`;
            config += `<span class="config-keyword"> class class-default</span>\n`;
            config += `<span class="config-keyword">  bandwidth percent 65</span>\n`;
            config += `<span class="config-keyword"> exit</span>\n\n`;
            
            config += `<span class="config-comment">! Application QoS sur l'interface uplink</span>\n`;
            config += `<span class="config-keyword">interface GigabitEthernet0/0</span>\n`;
            config += `<span class="config-keyword"> description</span> <span class="config-string">Uplink vers Internet/FW</span>\n`;
            config += `<span class="config-keyword"> service-policy output ENTERPRISE-QOS</span>\n`;
            config += `<span class="config-keyword"> no shutdown</span>\n`;
            config += `<span class="config-keyword"> exit</span>\n\n`;
            
            config += `<span class="config-comment">! Configuration NTP pour la synchronisation horaire</span>\n`;
            config += `<span class="config-keyword">ntp server</span> <span class="config-number">pool.ntp.org</span>\n`;
            config += `<span class="config-keyword">ntp source</span> <span class="config-keyword">Vlan</span><span class="config-number">60</span>\n\n`;
            
            config += `<span class="config-comment">! Logging et monitoring</span>\n`;
            config += `<span class="config-keyword">logging host</span> <span class="config-number">192.168.100.10</span>\n`;
            config += `<span class="config-keyword">logging trap</span> <span class="config-number">6</span>\n`;
            config += `<span class="config-keyword">logging source-interface</span> <span class="config-keyword">Vlan</span><span class="config-number">60</span>\n\n`;
            
            config += `<span class="config-comment">! Sauvegarde finale</span>\n`;
            config += `<span class="config-keyword">archive</span>\n`;
            config += `<span class="config-keyword"> path flash:/config-backups/$h-$t</span>\n`;
            config += `<span class="config-keyword"> write-memory</span>\n`;
            config += `<span class="config-keyword">wr mem</span>\n`;
            
            document.getElementById('seniorCode').innerHTML = config;
        }

        function updateExportCards() {
            const exportCards = document.getElementById('exportCards');
            exportCards.innerHTML = AppState.results.map(result => `
                <div class="subnet-card">
                    <h4>VLAN ${result.vlan} - ${result.name}</h4>
                    <div style="margin-bottom: 1rem;">
                        <strong>Description:</strong> ${result.description}<br>
                        <strong>Statut:</strong> ${result.critical ? 'üîí Critique' : '‚ö° Standard'}
                    </div>
                    <div style="background: var(--light); padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                        <strong>Configuration R√©seau:</strong><br>
                        ‚Ä¢ R√©seau: ${result.network}/${result.prefix}<br>
                        ‚Ä¢ Gateway: ${result.firstIP}<br>
                        ‚Ä¢ DHCP: ${result.firstIP} - ${result.lastIP}<br>
                        ‚Ä¢ Broadcast: ${result.broadcast}<br>
                        ‚Ä¢ H√¥tes: ${result.requested}/${result.hosts}
                    </div>
                    <div style="background: #e3f2fd; padding: 1rem; border-radius: 8px;">
                        <strong>Configuration Switch:</strong><br>
                        <code>vlan ${result.vlan}<br>name "${result.name}"</code>
                    </div>
                </div>
            `).join('');
        }

        // Fonctions d'export
        function exportToExcel() {
            if (AppState.results.length === 0) {
                alert('Aucun r√©sultat √† exporter');
                return;
            }
            
            const wb = XLSX.utils.book_new();
            
            // Feuille principale
            const wsData = [
                ['PLAN DE R√âSEAU VLSM - ENTREPRISE'],
                ['G√©n√©r√© le:', new Date().toLocaleDateString('fr-FR')],
                [''],
                ['VLAN', 'D√©partement', 'R√©seau', 'Masque', 'H√¥tes Demand√©s', 'H√¥tes Allou√©s', 'Gateway', 'Plage Utilisable', 'Broadcast', 'Statut']
            ];
            
            AppState.results.forEach(result => {
                wsData.push([
                    result.vlan,
                    result.name,
                    result.network,
                    `/${result.prefix}`,
                    result.requested,
                    result.hosts,
                    result.firstIP,
                    `${result.firstIP} - ${result.lastIP}`,
                    result.broadcast,
                    result.critical ? 'CRITIQUE' : 'STANDARD'
                ]);
            });
            
            const ws = XLSX.utils.aoa_to_sheet(wsData);
            XLSX.utils.book_append_sheet(wb, ws, 'Plan R√©seau');
            
            // Feuille de configuration
            const configData = [
                ['CONFIGURATION ROUTEUR - SYNTH√àSE'],
                [''],
                ['VLAN', 'Interface', 'Adresse IP', 'Masque', 'Description']
            ];
            
            AppState.results.forEach(result => {
                configData.push([
                    result.vlan,
                    `Vlan${result.vlan}`,
                    result.firstIP,
                    `255.255.255.${256 - Math.pow(2, 32 - result.prefix)}`,
                    `Gateway ${result.name}`
                ]);
            });
            
            const wsConfig = XLSX.utils.aoa_to_sheet(configData);
            XLSX.utils.book_append_sheet(wb, wsConfig, 'Configuration');
            
            XLSX.writeFile(wb, `plan_reseau_entreprise_${new Date().toISOString().split('T')[0]}.xlsx`);
        }

        function exportToPDF() {
            if (AppState.results.length === 0) {
                alert('Aucun r√©sultat √† exporter');
                return;
            }
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // En-t√™te
            doc.setFontSize(20);
            doc.text('PLAN DE R√âSEAU ENTREPRISE - VLSM', 20, 30);
            doc.setFontSize(12);
            doc.text(`Document g√©n√©r√© le ${new Date().toLocaleDateString('fr-FR')}`, 20, 40);
            doc.text(`Architecture r√©seau pour ${AppState.departments.length} d√©partements`, 20, 50);
            
            let y = 70;
            
            // Tableau des VLANs
            doc.setFont(undefined, 'bold');
            doc.text('TABLEAU DES VLANs ET SOUS-R√âSEAUX', 20, y);
            y += 10;
            
            doc.setFontSize(10);
            const headers = ['VLAN', 'D√©partement', 'R√©seau', 'Gateway', 'Plage IP', 'H√¥tes'];
            let x = 20;
            
            headers.forEach(header => {
                doc.setFont(undefined, 'bold');
                doc.text(header, x, y);
                x += header === 'D√©partement' ? 40 : 30;
            });
            
            y += 8;
            doc.line(20, y, 190, y);
            y += 5;
            
            AppState.results.forEach((result, index) => {
                if (y > 270) {
                    doc.addPage();
                    y = 20;
                    doc.setFontSize(10);
                }
                
                x = 20;
                doc.setFont(undefined, 'normal');
                doc.text(result.vlan.toString(), x, y);
                x += 30;
                doc.text(result.name, x, y);
                x += 40;
                doc.text(`${result.network}/${result.prefix}`, x, y);
                x += 30;
                doc.text(result.firstIP, x, y);
                x += 30;
                doc.text(`${result.firstIP}-${result.lastIP}`, x, y);
                x += 30;
                doc.text(`${result.requested}/${result.hosts}`, x, y);
                
                y += 8;
                
                // Ligne s√©paratrice
                if (index < AppState.results.length - 1) {
                    doc.line(20, y, 190, y);
                    y += 5;
                }
            });
            
            // Page de configuration
            doc.addPage();
            y = 20;
            
            doc.setFontSize(16);
            doc.text('CONFIGURATIONS ROUTEUR', 20, y);
            y += 15;
            
            doc.setFontSize(10);
            doc.setFont(undefined, 'bold');
            doc.text('Commandes Cisco essentielles:', 20, y);
            y += 8;
            
            doc.setFont(undefined, 'normal');
            doc.text('enable', 25, y);
            y += 5;
            doc.text('configure terminal', 25, y);
            y += 5;
            
            AppState.results.forEach(result => {
                if (y > 270) {
                    doc.addPage();
                    y = 20;
                }
                
                doc.text(`vlan ${result.vlan}`, 25, y);
                y += 5;
                doc.text(`name "${result.name}"`, 30, y);
                y += 5;
                doc.text(`interface Vlan${result.vlan}`, 25, y);
                y += 5;
                doc.text(`ip address ${result.firstIP} 255.255.255.${256 - Math.pow(2, 32 - result.prefix)}`, 30, y);
                y += 5;
                doc.text(`description Gateway ${result.name}`, 30, y);
                y += 5;
                doc.text(`no shutdown`, 30, y);
                y += 8;
            });
            
            doc.text('write memory', 25, y);
            
            doc.save(`configuration_reseau_${new Date().toISOString().split('T')[0]}.pdf`);
        }

        // Fonctions utilitaires
        function loadExample() {
            document.getElementById('network').value = '192.168.0.0';
            document.getElementById('mask').value = '/22';
            document.getElementById('subnetCount').value = 4;
            generateDepartmentInputs();
        }

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            AppState.init();
            
            if (!localStorage.getItem('vlsm-pro-calculator')) {
                setTimeout(loadExample, 500);
            }
        });
    </script>
</body>
</html>
